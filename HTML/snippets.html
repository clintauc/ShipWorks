<!-- GENARATE BARCODE START -->

<table style="width:{$pageWidth};" align="right">
    <td style="width: 70%;"></td>
        <td>Order #: 
            <xsl:value-of select="//Order/Number" />-   
            <xsl:value-of select="//Order/Number" /> W
            <br /> <br /> 
            <font size="30" face="Free 3 of 9 Extended" color="black" style="white-space: nowrap;">*<xsl:value-of select="//Order/Number"/>W*</font>
        </td>
</table>

<!-- GENARATE BARCODE END -->



<!-- Charges in Item -->
<xsl:value-of select="Charge[type = 'SHIPPING']/Amount" />

</xsl:template>
</xsl:stylesheet>

AmazonOrderID
<!-- //Order/Amazon/AmazonOrderID   -->

Walmart Order ID
<!-- //Order/Walmart/PurchaseOrderID   -->


<!--RUN COMMAND SAMPLES START-->
osql -S LOKI\SHIPWORKS -U sa -P ShipW@rks1 -H 0000100001 -d ShipWorks -q "SET ANSI_NULLS, QUOTED_IDENTIFIER ON;Update [order] 
set Custom3='{//Order/Shipment[Status='Processed'][position()=last()]/TotalWeight}' where OrderID={//Order/@ID};"

<!--Copy Quantity to Custom2 Item Level-->
sqlcmd -S THREE\Shipworks -E -H 0000100001 -d ShipWorks -q "/*{//Order/Number}*/ 
SET QUOTED_IDENTIFIER ON;<xsl:variable name="apos">'"</xsl:variable><xsl:for-each select="//Order/Item[contains(Product/Name,'Pack of')]">
UPDATE OrderItem SET Quantity=Quantity * {substring-after(Product/Name,'Pack of ')},Name='{translate(substring-before(Product/Name,' Pack of'),$apos,'')}', UnitPrice = (UnitPrice / {substring-after(Product/Name,'Pack of ')}),Custom1='PoQ' 
WHERE OrderItemID={@ID} AND Custom1 != 'PoQ';</xsl:for-each>"

<!-- Copy Field-->
SQLCMD -S WIN-1YBTBY3\SHIPWORKS -U sa -P ShipW@rks1 -H 0000100001 -d ShipWorks -Q "SET QUOTED_IDENTIFIER ON;<xsl:for-each 
select="//Order/Item">UPDATE OrderItem SET HarmonizedCode = (Select Custom1 FROM OrderItem Where OrderItemID={@ID}) 
FROM OrderItem X JOIN [Order] O ON X.OrderID=O.OrderID WHERE X.OrderItemID = {@ID}<xsl:if test="position()!=last()">;</xsl:if></xsl:for-each>"

<!--RUN COMMAND SAMPLES END-->




<!--Code to call-->


<!--Store Name Single order-->
<xsl:value-of select="Store/StoreName" />

<!--Store Name Multiple Order-->
    <xsl:variable name="storeid" select="@storeID"/>
        <xsl:value-of select="//Store[@ID = $storeid]/StoreName" /><xsl:text>,</xsl:text>


        
